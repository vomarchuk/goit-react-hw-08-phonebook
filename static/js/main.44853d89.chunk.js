(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[1],{10:function(e,t,r){e.exports={nav_bar:"NavBar_nav_bar__1hgvk",nav_item:"NavBar_nav_item__38viu",user_menu:"NavBar_user_menu__GfI1r",logOutBtn:"NavBar_logOutBtn__30N8I"}},12:function(e,t,r){"use strict";var n=r(20),a=r(9),c=r.n(a),s=r(7),i=r(17),o=r.n(i);o.a.defaults.baseURL="https://connections-api.herokuapp.com";var u=function(e){o.a.defaults.headers.common.Authorization="Bearer ".concat(e)},l=function(){o.a.defaults.headers.common.Authorization=""},d=Object(s.b)("/auth/refresh",function(){var e=Object(n.a)(c.a.mark((function e(t,r){var n,a,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.getState(),null!==(a=n.auth.token)){e.next=4;break}return e.abrupt("return",r.rejectedWithValue());case 4:return u(a),e.prev=5,e.next=8,o.a.get("/users/current");case 8:return s=e.sent,i=s.data,e.abrupt("return",i);case 13:throw e.prev=13,e.t0=e.catch(5),e.t0;case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,r){return e.apply(this,arguments)}}()),j=Object(s.b)("auth/register",function(){var e=Object(n.a)(c.a.mark((function e(t){var r,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.post("/users/signup",t);case 3:return r=e.sent,n=r.data,u(n.token),e.abrupt("return",n);case 9:throw e.prev=9,e.t0=e.catch(0),alert("Sorry. A user with that email address already exists, or the email was invalid."),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),b=Object(s.b)("auth/login",function(){var e=Object(n.a)(c.a.mark((function e(t){var r,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.post("/users/login",t);case 3:return r=e.sent,n=r.data,u(n.token),e.abrupt("return",n);case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),h={userRegister:j,logIn:b,logOut:Object(s.b)("auth/logout",Object(n.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.post("/users/logout");case 3:l(),e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))),fetchCurrentUser:d};t.a=h},18:function(e,t,r){"use strict";var n={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUserName:function(e){return e.auth.user.name},getIsFechingCurrent:function(e){return e.auth.isFechingCurrent}};t.a=n},24:function(e,t,r){"use strict";var n=r(20),a=r(9),c=r.n(a),s=r(7),i=r(17),o=r.n(i);o.a.defaults.baseURL="https://connections-api.herokuapp.com";var u=Object(s.b)("contacts",Object(n.a)(c.a.mark((function e(){var t,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.get("/contacts");case 3:return t=e.sent,r=t.data,e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))),l=Object(s.b)("contacts/add",function(){var e=Object(n.a)(c.a.mark((function e(t){var r,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.post("/contacts",t);case 3:return r=e.sent,n=r.data,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()),d=Object(s.b)("contact/remove",function(){var e=Object(n.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.delete("/contacts/".concat(t));case 3:return e.abrupt("return",t);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()),j={getAllContacts:u,addContact:l,removeContact:d,filter:Object(s.b)("/auth/filter",(function(e){return e}))};t.a=j},51:function(e,t,r){e.exports={wrapper:"Wrapper_wrapper__acrmz"}},52:function(e,t,r){e.exports={container:"Container_container__3RIox"}},60:function(e,t,r){},88:function(e,t,r){"use strict";r.r(t);var n,a,c=r(0),s=r.n(c),i=r(27),o=r.n(i),u=r(19),l=r(5),d=r(49),j=(r(60),r(61),r(3)),b=r(4),h=r(22),f=r(18),O=r(1),p=["children","redirectTo"],g=function(e){var t=e.children,r=e.redirectTo,n=void 0===r?"/":r,a=Object(h.a)(e,p),c=Object(l.c)(f.a.getIsLoggedIn);return Object(O.jsx)(j.b,Object(b.a)(Object(b.a)({},a),{},{children:c?t:Object(O.jsx)(j.a,{to:n})}))},v=["children","restricted","redirectTo"],m=function(e){var t=e.children,r=e.restricted,n=void 0!==r&&r,a=e.redirectTo,c=void 0===a?"/":a,s=Object(h.a)(e,v),i=Object(l.c)(f.a.getIsLoggedIn)&&n;return Object(O.jsx)(j.b,Object(b.a)(Object(b.a)({},s),{},{children:i?Object(O.jsx)(j.a,{to:c}):t}))},x=r(51),w=r.n(x),_=function(e){var t=e.children;return Object(O.jsx)("div",{className:w.a.wrapper,children:t})},k=r(52),I=r.n(k),C=function(e){var t=e.children;return Object(O.jsx)("div",{className:I.a.container,children:t})},y=function(e){var t=e.children;return Object(O.jsx)("section",{children:Object(O.jsx)(C,{children:t})})},N=r(10),L=r.n(N),B=function(){return Object(O.jsxs)("div",{className:L.a.auth_nav,children:[Object(O.jsx)(u.b,{className:"".concat(L.a.nav_item," "),to:"/register",children:"Register"}),Object(O.jsx)(u.b,{className:"".concat(L.a.nav_item," "),to:"/login",children:"Login"})]})},R=r(12),U=r(90),z=r.p+"static/media/logout.a6eede60.svg",T=function(){var e=Object(l.c)(f.a.getUserName),t=Object(l.b)();return Object(O.jsxs)("div",{className:L.a.user_menu,children:[Object(O.jsxs)("span",{className:L.a.s,children:["Wellcome, ",e]}),Object(O.jsx)(U.a,{className:L.a.logOutBtn,variant:"danger",onClick:function(){return t(R.a.logOut())},type:"button",children:Object(O.jsx)("img",{className:L.a.icon,src:z,width:"20",height:"20",alt:"logout button"})})]})},F=function(){var e=Object(l.c)(f.a.getIsLoggedIn);return Object(O.jsxs)("nav",{className:L.a.navigations,children:[Object(O.jsx)(u.b,{className:L.a.nav_item,to:"/",children:"Home"}),e&&Object(O.jsx)(u.b,{className:L.a.nav_item,to:"/contacts",children:"Contacts"})]})},A=function(){var e=Object(l.c)(f.a.getIsLoggedIn);return Object(O.jsxs)("header",{className:L.a.nav_bar,children:[Object(O.jsx)(F,{}),e?Object(O.jsx)(T,{}):Object(O.jsx)(B,{})]})},S=Object(c.lazy)((function(){return r.e(8).then(r.bind(null,107))})),P=Object(c.lazy)((function(){return Promise.all([r.e(0),r.e(6)]).then(r.bind(null,110))})),W=Object(c.lazy)((function(){return Promise.all([r.e(0),r.e(7)]).then(r.bind(null,111))})),E=Object(c.lazy)((function(){return Promise.all([r.e(0),r.e(5),r.e(4)]).then(r.bind(null,109))})),J=function(){var e=Object(l.c)(f.a.getIsFechingCurrent),t=Object(l.b)();return Object(c.useEffect)((function(){t(R.a.fetchCurrentUser())}),[t]),!e&&Object(O.jsxs)(_,{children:[Object(O.jsx)(y,{children:Object(O.jsx)(A,{})}),Object(O.jsx)(c.Suspense,{fallback:Object(O.jsx)("div",{children:"...Loading"}),children:Object(O.jsx)(y,{children:Object(O.jsxs)(j.d,{children:[Object(O.jsx)(m,{exact:!0,path:"/",children:Object(O.jsx)(S,{})}),Object(O.jsx)(m,{path:"/register",restricted:!0,redirectTo:"/contacts",children:Object(O.jsx)(W,{})}),Object(O.jsx)(m,{path:"/login",restricted:!0,redirectTo:"/contacts",children:Object(O.jsx)(P,{})}),Object(O.jsx)(g,{path:"/contacts",redirectTo:"/",children:Object(O.jsx)(E,{})})]})})})]})},G=r(7),H=r(21),M=r(53),V=r.n(M),q=r(6),D=r(24),K=Object(G.c)({name:"contacts",initialState:{items:null,filter:""},extraReducers:(n={},Object(q.a)(n,D.a.getAllContacts.fulfilled,(function(e,t){e.items=t.payload})),Object(q.a)(n,D.a.addContact.fulfilled,(function(e,t){e.items.push(t.payload)})),Object(q.a)(n,D.a.removeContact.fulfilled,(function(e,t){e.items=e.items.filter((function(e){return e.id!==t.payload}))})),Object(q.a)(n,D.a.filter.fulfilled,(function(e,t){e.filter=t.payload})),n)}).reducer,Q=Object(G.c)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,error:null,isFechingCurrent:!1},extraReducers:(a={},Object(q.a)(a,R.a.fetchCurrentUser.pending,(function(e,t){e.isFechingCurrent=!0})),Object(q.a)(a,R.a.fetchCurrentUser.fulfilled,(function(e,t){var r=t.payload;e.user=r,e.isLoggedIn=!0,e.isFechingCurrent=!1,e.error=null})),Object(q.a)(a,R.a.fetchCurrentUser.rejected,(function(e,t){var r=t.error;e.isLoggedIn=!1,e.isFechingCurrent=!1,e.error=null===r||void 0===r?void 0:r.message})),Object(q.a)(a,R.a.userRegister.fulfilled,(function(e,t){var r=t.payload;e.user=r.user,e.token=r.token,e.isLoggedIn=!0,e.error=null})),Object(q.a)(a,R.a.userRegister.rejected,(function(e,t){var r=t.error;e.isLoggedIn=!1,e.error=null===r||void 0===r?void 0:r.message})),Object(q.a)(a,R.a.logIn.fulfilled,(function(e,t){var r=t.payload;e.user=r.user,e.token=r.token,e.isLoggedIn=!0,e.error=null})),Object(q.a)(a,R.a.logIn.rejected,(function(e,t){var r=t.error;e.isLoggedIn=!1,e.error=null===r||void 0===r?void 0:r.message})),Object(q.a)(a,R.a.logOut.fulfilled,(function(e,t){e.user={name:null,email:null},e.token=null,e.isLoggedIn=!1,e.error=null})),Object(q.a)(a,R.a.logOut.rejected,(function(e,t){var r=t.error;e.error=null===r||void 0===r?void 0:r.message})),a)}).reducer,X={key:"auth",storage:V.a,whitelist:["token"]},Y=Object(G.a)({reducer:{auth:Object(H.g)(X,Q),contacts:K},middleware:Object(G.d)({serializableCheck:{ignoredActions:[H.a,H.f,H.b,H.c,H.d,H.e]}}),devTools:!1}),Z=Object(H.h)(Y);o.a.render(Object(O.jsxs)(s.a.StrictMode,{children:[Object(O.jsx)(l.a,{store:Y,children:Object(O.jsx)(d.a,{loading:null,persistor:Z,children:Object(O.jsx)(u.a,{children:Object(O.jsx)(J,{})})})}),","]}),document.getElementById("root"))}},[[88,2,3]]]);
//# sourceMappingURL=main.44853d89.chunk.js.map